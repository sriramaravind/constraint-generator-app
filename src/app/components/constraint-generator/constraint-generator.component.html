<!-- constraint-generator.component.html -->
<mat-card class="constraint-card">
  <mat-card-title>   Please enter the rule text and upload the JSON file</mat-card-title>
  <mat-card-content>

    <!-- Constraint Message -->
    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Rule Text</mat-label>
      <textarea
        matInput
        cdkTextareaAutosize 
        cdkAutosizeMinRows="6"
        cdkAutosizeMaxRows="20"  
        [(ngModel)]="constraintMessage"
        placeholder="Enter or paste the rule text here">
      </textarea>
    </mat-form-field>

    <!-- JSON Upload -->
    <div class="upload-field">
      <label style="color: rgb(0, 92, 185);"><strong>Upload JSON File</strong></label>
      <br />
      <button mat-raised-button color="primary" (click)="triggerFileInput()">
        <mat-icon>upload</mat-icon>
        Choose File
      </button>
      <input
        #jsonFileInput
        type="file"
        (change)="onFileSelected($event)"
        accept=".json"
        style="display: none;"
      />
      <span>{{ '  '+selectedFileName || '  No file chosen...' }}</span>      
    </div>

    <!-- Generate Button + Spinner -->
    <div class="btn-row">
      <button
        mat-raised-button
        color="primary"
        (click)="generateConstraint()"
        [disabled]="loading"
      >
        <mat-icon *ngIf="!loading">build</mat-icon>
        <mat-icon *ngIf="loading" class="spin">autorenew</mat-icon>
        <span *ngIf="!loading">Generate Constraint</span>
        <span *ngIf="loading">Generating...</span>
      </button>

      <!-- Optional: Material spinner (if you like) -->
      <mat-progress-spinner
        *ngIf="loading"
        mode="indeterminate"
        diameter="24"
        strokeWidth="4">
      </mat-progress-spinner>
    </div>

    <!-- Generated Constraint -->
    <mat-form-field appearance="fill" class="full-width mt-3">
      <mat-label>Generated Constraint</mat-label>
      <textarea
        matInput
        cdkTextareaAutosize
        cdkAutosizeMinRows="6"
        cdkAutosizeMaxRows="20"        
        #autosize="cdkTextareaAutosize" 
        readonly
        [value]="generatedConstraint">
      </textarea>
    </mat-form-field>      

    <!-- Copy Button -->
    <button
      mat-raised-button
      color="primary"
      (click)="copyConstraint()"
      [disabled]="!generatedConstraint">
      <mat-icon>content_copy</mat-icon>
      Copy Constraint
    </button>
  </mat-card-content>
</mat-card>